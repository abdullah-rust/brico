generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model User {
  id             String   @id @default(uuid()) @db.Uuid
  email          String   @unique
  password       String?
  createdAt      DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt      DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)
  address        String?
  fullName       String   @map("fullName") @db.VarChar(100)
  phoneNumber    String?  @map("phone_number") @db.VarChar(15)
  profilePicture String?  @map("profile_picture")
  role           String?  @default("CLIENT") @db.VarChar(20)
  workerProfile  Worker?
}

model Worker {
  id              String   @id @default(uuid()) @db.Uuid
  userId          String   @unique @map("user_id") @db.Uuid
  profession      String   @db.VarChar(100)
  bio             String?
  experienceYears Int      @map("experience_years")
  rating          Float    @default(0.0) @db.Real
  skills          String[]
  createdAt       DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt       DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)
  gigs            Gig[]
  user            User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Gig {
  id           String   @id @default(uuid()) @db.Uuid
  workerId     String   @map("worker_id") @db.Uuid
  title        String   @db.VarChar(255)
  description  String
  category     String   @db.VarChar(100)
  priceBase    Decimal  @map("price_base") @db.Decimal(10, 2)
  imageUrls    String[] @map("image_urls")
  isActive     Boolean  @default(true) @map("is_active")
  createdAt    DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt    DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)
  availability Json
  lat          Float
  lng          Float
  locationName String   @map("location_name") @db.VarChar(255)
  phone        String   @map("phone") @db.VarChar(15)
  rateType     String
  worker       Worker   @relation(fields: [workerId], references: [userId], onDelete: Cascade)

  @@index([category])
  @@index([workerId])
  @@index([lat, lng])
}


model DesignPost {
  id              Int      @id @default(autoincrement())
  title           String
  description     String?  @db.Text
  imageUrl        String   // S3 bucket ka direct link
  
  // Filtering & Categorization
  category        String   // e.g., "Elevations", "Maps", "Ceiling"
  sizeTag         String   // e.g., "5 Marla", "10 Marla", "1 Kanal"
  styleTag        String   // e.g., "Modern", "Spanish", "Classical"
  

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  // Performance Optimization: Search aur Filter ko fast karne ke liye indexing
  @@index([category])
  @@index([sizeTag, styleTag])
}


model Admin {
  id        String   @id @default(uuid()) @db.Uuid
  username  String   @unique
  password  String   

  createdAt DateTime @default(now()) @map("created_at") @db.Timestamptz(6)
  updatedAt DateTime @updatedAt @map("updated_at") @db.Timestamptz(6)

  @@map("admins")
}